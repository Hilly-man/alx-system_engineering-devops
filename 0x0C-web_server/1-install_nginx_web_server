#!/usr/bin/env bash
#Install nginx web server 

sudo apt-get update

# Install Nginx
sudo apt-get install -y nginx

# Create a default HTML page with "Hello World!"
echo "Hello World!" | sudo tee /var/www/html/index.html > /dev/null

# Check if Nginx is running and start it if necessary
if ! pgrep -x "nginx" >/dev/null; then
    sudo service nginx start
fi

# Ensure Nginx is set to listen on port 80
if ! grep -q "listen 80;" /etc/nginx/sites-available/default; then
    sudo sed -i 's/listen 80 default_server;/listen 80;/' /etc/nginx/sites-available/default
fi

# Reload Nginx to apply changes
sudo service nginx reload

# Verify that Nginx is running and listening on port 80
if [[ $(curl -s http://localhost | grep -c "Hello World!") -gt 0 ]]; then
    echo "Nginx is installed, configured, and running with 'Hello World!' response."
else
    echo "Nginx may not be configured correctly."
fi

